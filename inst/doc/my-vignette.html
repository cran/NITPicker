<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Daphne Ezer" />

<meta name="date" content="2018-06-27" />

<title>NITPicker</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">NITPicker</h1>
<h4 class="author"><em>Daphne Ezer</em></h4>
<h4 class="date"><em>2018-06-27</em></h4>



<p>Often, researchers will conduct a few high-resolution time course experiments (or densely sample points along a spatial axis), but then they must select a subset of points to sample in follow-up experiments due to financial constraints. NITPicker is a tool to select the best points to subsample. We present three different definitions of what constitutes a `good’ set of time points:</p>
<ul>
<li>(f1) A good set of time points is a set that can accurately be used to interpolate the complete shape of the curve over time. (i.e. We select a subset of time points that minise the L2-error between the curve interpolated between the sampled points and the curve interpolated between all the points in the high resolution time course)</li>
<li>(f2) A good set of points is a set that can accurately distinguish the shape of the curve representing the difference between the experimental condition and the control. In other words, we calculate the difference between the control curve and the experimental curve, and then apply f1.</li>
<li>(f3) A good set of points is a set that can accurately distinguish the shape of the inverse coefficient of variation.</li>
</ul>
<p>Please note that this is not a very fast value to compute– it may take a few hours to complete on a large dataset. The precise definition and motivation for these three criteria can be found at: <a href="https://doi.org/10.1101/301796" class="uri">https://doi.org/10.1101/301796</a></p>
<p>Please note that this package relies heavily on the fdasrvf package, which is used to generate probability distributions of curves, based on a set of example functions.</p>
<div id="references" class="section level2">
<h2>References</h2>
<p>Please cite the following if you use this R package:</p>
<p>Ezer, D. and Keir J.C. Selection of time points for costly experiments: a comparison between human intuition and computer-aided experimental design. bioarxiv, :10.1101/301796 (2018).</p>
<hr />
<p>It might also be advisable to cite this paper, which presents the fdasrvf package which is an important part of this project:</p>
<p>Tucker, J. D., Wu, W., Srivastava, A., Generative Models for Function Data using Phase and Amplitude Separation, Computational Statistics and Data Analysis (2012), 10.1016/j.csda.2012.12.001.</p>
<p>For more background on why it might be useful to minimise the L2-error for finding optimal time points to sample, please see:</p>
<p>Michael Kleyman, Emre Sefer, Teodora Nicola, Celia Espinoza, Divya Chhabra, James S Hagood, Naftali Kaminski, Namasivayam Ambalavanan, Ziv Bar-Joseph. Selecting the most appropriate time points to profile in high-throughput studies. eLife 2017;6:e18541 (2017).</p>
</div>
<div id="demo-of-f1" class="section level2">
<h2>Demo of F1</h2>
<p>In this example, we try to find 4 months to subsample that will let us estimate the shape of the curves as accurately as possible (minimise L2-error). In this case, we sample only 3 example curves from the distribution of curves when estimating the integral– this should be much higher (100 curves is usually suitable), but we make it 3 here to speed up loading the vignette.</p>
<p>Note that the tables that are printed as the evaluation are the optimisation tables that are used as part of the NITPicker algorithm’s dynamic programming algorithm.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(fda)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: splines</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: Matrix</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="co">#&gt; Attaching package: 'fda'</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="co">#&gt; The following object is masked from 'package:graphics':</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="co">#&gt;     matplot</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(NITPicker)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="co">#&gt; Loading required package: fdasrvf</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="co">#&gt; Loading required package: fda.usc</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co">#&gt; Loading required package: MASS</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co">#&gt; Loading required package: mgcv</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="co">#&gt; Loading required package: nlme</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="co">#&gt; This is mgcv 1.8-23. For overview type 'help(&quot;mgcv-package&quot;)'.</span></a>
<a class="sourceLine" id="cb1-16" data-line-number="16"><span class="co">#&gt; Loading required package: rpart</span></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"> mat=CanadianWeather<span class="op">$</span>monthlyTemp <span class="co">#load data - a matrix with 12 rows, representing months (time); and 35 columns, representing cities (experiments)</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"> a=<span class="kw">findPathF1</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), mat, <span class="dv">4</span>, <span class="dt">numPerts=</span><span class="dv">500</span>) <span class="co">#find a set of points that help predict the shape of the curve</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; lambda =   0.0 </span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; Initializing...</span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; Computing Karcher mean of 35 functions in SRSF space...</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt; updating step: r=1</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt; updating step: r=2</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt; updating step: r=3</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt; updating step: r=4</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt; updating step: r=5</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt; updating step: r=6</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt; updating step: r=7</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt; updating step: r=8</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt; updating step: r=9</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt; updating step: r=10</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt; updating step: r=11</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt; updating step: r=12</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt; updating step: r=13</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; updating step: r=14</span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; updating step: r=15</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt; updating step: r=16</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt; updating step: r=17</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; updating step: r=18</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"><span class="co">#&gt; [1] 12  1</span></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co">#&gt; [1,]    0</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"><span class="co">#&gt; [2,]  Inf</span></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co">#&gt; [3,]  Inf</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="co">#&gt; [4,]  Inf</span></a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="co">#&gt; [5,]  Inf</span></a>
<a class="sourceLine" id="cb1-48" data-line-number="48"><span class="co">#&gt;          [,1] [,2]</span></a>
<a class="sourceLine" id="cb1-49" data-line-number="49"><span class="co">#&gt; [1,] 94119.21  Inf</span></a>
<a class="sourceLine" id="cb1-50" data-line-number="50"><span class="co">#&gt; [2,]      Inf    0</span></a>
<a class="sourceLine" id="cb1-51" data-line-number="51"><span class="co">#&gt; [3,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb1-52" data-line-number="52"><span class="co">#&gt; [4,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb1-53" data-line-number="53"><span class="co">#&gt; [5,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb1-54" data-line-number="54"><span class="co">#&gt;         [,1]     [,2]     [,3]</span></a>
<a class="sourceLine" id="cb1-55" data-line-number="55"><span class="co">#&gt; [1,] 7227618      Inf      Inf</span></a>
<a class="sourceLine" id="cb1-56" data-line-number="56"><span class="co">#&gt; [2,]     Inf 395438.2 94119.21</span></a>
<a class="sourceLine" id="cb1-57" data-line-number="57"><span class="co">#&gt; [3,]     Inf      Inf     0.00</span></a>
<a class="sourceLine" id="cb1-58" data-line-number="58"><span class="co">#&gt; [4,]     Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb1-59" data-line-number="59"><span class="co">#&gt; [5,]     Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb1-60" data-line-number="60"><span class="co">#&gt;          [,1]    [,2]     [,3]       [,4]</span></a>
<a class="sourceLine" id="cb1-61" data-line-number="61"><span class="co">#&gt; [1,] 54302055     Inf      Inf        Inf</span></a>
<a class="sourceLine" id="cb1-62" data-line-number="62"><span class="co">#&gt; [2,]      Inf 2759868 270921.9 7227618.08</span></a>
<a class="sourceLine" id="cb1-63" data-line-number="63"><span class="co">#&gt; [3,]      Inf     Inf 176802.6   94119.21</span></a>
<a class="sourceLine" id="cb1-64" data-line-number="64"><span class="co">#&gt; [4,]      Inf     Inf      Inf       0.00</span></a>
<a class="sourceLine" id="cb1-65" data-line-number="65"><span class="co">#&gt; [5,]      Inf     Inf      Inf        Inf</span></a>
<a class="sourceLine" id="cb1-66" data-line-number="66"><span class="co">#&gt;           [,1]    [,2]     [,3]       [,4]        [,5]</span></a>
<a class="sourceLine" id="cb1-67" data-line-number="67"><span class="co">#&gt; [1,] 162631616     Inf      Inf        Inf         Inf</span></a>
<a class="sourceLine" id="cb1-68" data-line-number="68"><span class="co">#&gt; [2,]       Inf 5511374 444956.9 7232202.59 54302054.87</span></a>
<a class="sourceLine" id="cb1-69" data-line-number="69"><span class="co">#&gt; [3,]       Inf     Inf 350837.7   98703.72   270921.86</span></a>
<a class="sourceLine" id="cb1-70" data-line-number="70"><span class="co">#&gt; [4,]       Inf     Inf      Inf    4584.51    94119.21</span></a>
<a class="sourceLine" id="cb1-71" data-line-number="71"><span class="co">#&gt; [5,]       Inf     Inf      Inf        Inf        0.00</span></a>
<a class="sourceLine" id="cb1-72" data-line-number="72"><span class="co">#&gt;           [,1]    [,2]     [,3]      [,4]        [,5]         [,6]</span></a>
<a class="sourceLine" id="cb1-73" data-line-number="73"><span class="co">#&gt; [1,] 310482479     Inf      Inf       Inf         Inf          Inf</span></a>
<a class="sourceLine" id="cb1-74" data-line-number="74"><span class="co">#&gt; [2,]       Inf 5752868 351909.8 7545230.9 54382889.07 162631616.49</span></a>
<a class="sourceLine" id="cb1-75" data-line-number="75"><span class="co">#&gt; [3,]       Inf     Inf 257790.6  411732.0   351756.05    444956.87</span></a>
<a class="sourceLine" id="cb1-76" data-line-number="76"><span class="co">#&gt; [4,]       Inf     Inf      Inf  317612.8   174953.40     98703.72</span></a>
<a class="sourceLine" id="cb1-77" data-line-number="77"><span class="co">#&gt; [5,]       Inf     Inf      Inf       Inf    80834.19      4584.51</span></a>
<a class="sourceLine" id="cb1-78" data-line-number="78"><span class="co">#&gt;           [,1]    [,2]    [,3]     [,4]     [,5]        [,6]         [,7]</span></a>
<a class="sourceLine" id="cb1-79" data-line-number="79"><span class="co">#&gt; [1,] 426724724     Inf     Inf      Inf      Inf         Inf          Inf</span></a>
<a class="sourceLine" id="cb1-80" data-line-number="80"><span class="co">#&gt; [2,]       Inf 4555736 3155093 10879139 55772283 162862863.2 310482479.10</span></a>
<a class="sourceLine" id="cb1-81" data-line-number="81"><span class="co">#&gt; [3,]       Inf     Inf 3060974  3745641  1741150    676203.5    351909.84</span></a>
<a class="sourceLine" id="cb1-82" data-line-number="82"><span class="co">#&gt; [4,]       Inf     Inf     Inf  3651521  1564347    329950.4    257790.63</span></a>
<a class="sourceLine" id="cb1-83" data-line-number="83"><span class="co">#&gt; [5,]       Inf     Inf     Inf      Inf  1470228    235831.2     98703.72</span></a>
<a class="sourceLine" id="cb1-84" data-line-number="84"><span class="co">#&gt;           [,1]     [,2]     [,3]     [,4]     [,5]      [,6]        [,7]</span></a>
<a class="sourceLine" id="cb1-85" data-line-number="85"><span class="co">#&gt; [1,] 391589760      Inf      Inf      Inf      Inf       Inf         Inf</span></a>
<a class="sourceLine" id="cb1-86" data-line-number="86"><span class="co">#&gt; [2,]       Inf 21653899 28434775 32224711 67200690 166965369 311175729.0</span></a>
<a class="sourceLine" id="cb1-87" data-line-number="87"><span class="co">#&gt; [3,]       Inf      Inf 28340656 25091213 13169557   4778709   1045159.7</span></a>
<a class="sourceLine" id="cb1-88" data-line-number="88"><span class="co">#&gt; [4,]       Inf      Inf      Inf 24997093 12992755   4432456    951040.5</span></a>
<a class="sourceLine" id="cb1-89" data-line-number="89"><span class="co">#&gt; [5,]       Inf      Inf      Inf      Inf 12898635   4338337    791953.6</span></a>
<a class="sourceLine" id="cb1-90" data-line-number="90"><span class="co">#&gt;             [,8]</span></a>
<a class="sourceLine" id="cb1-91" data-line-number="91"><span class="co">#&gt; [1,]         Inf</span></a>
<a class="sourceLine" id="cb1-92" data-line-number="92"><span class="co">#&gt; [2,] 426724724.5</span></a>
<a class="sourceLine" id="cb1-93" data-line-number="93"><span class="co">#&gt; [3,]   3155093.1</span></a>
<a class="sourceLine" id="cb1-94" data-line-number="94"><span class="co">#&gt; [4,]    351909.8</span></a>
<a class="sourceLine" id="cb1-95" data-line-number="95"><span class="co">#&gt; [5,]    257790.6</span></a>
<a class="sourceLine" id="cb1-96" data-line-number="96"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb1-97" data-line-number="97"><span class="co">#&gt; [1,] 244781356       Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-98" data-line-number="98"><span class="co">#&gt; [2,]       Inf 112045310 121546437 105804433 111044479 187340235 317485475</span></a>
<a class="sourceLine" id="cb1-99" data-line-number="99"><span class="co">#&gt; [3,]       Inf       Inf 121452318  98670934  57013346  25153575   7354906</span></a>
<a class="sourceLine" id="cb1-100" data-line-number="100"><span class="co">#&gt; [4,]       Inf       Inf       Inf  98576815  56836544  24807322   7260787</span></a>
<a class="sourceLine" id="cb1-101" data-line-number="101"><span class="co">#&gt; [5,]       Inf       Inf       Inf       Inf  56742424  24713203   7101700</span></a>
<a class="sourceLine" id="cb1-102" data-line-number="102"><span class="co">#&gt;             [,8]        [,9]</span></a>
<a class="sourceLine" id="cb1-103" data-line-number="103"><span class="co">#&gt; [1,]         Inf         Inf</span></a>
<a class="sourceLine" id="cb1-104" data-line-number="104"><span class="co">#&gt; [2,] 427432129.4 391589760.3</span></a>
<a class="sourceLine" id="cb1-105" data-line-number="105"><span class="co">#&gt; [3,]   3862498.0  21653899.0</span></a>
<a class="sourceLine" id="cb1-106" data-line-number="106"><span class="co">#&gt; [4,]   1059314.8   1045159.7</span></a>
<a class="sourceLine" id="cb1-107" data-line-number="107"><span class="co">#&gt; [5,]    965195.6    351909.8</span></a>
<a class="sourceLine" id="cb1-108" data-line-number="108"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb1-109" data-line-number="109"><span class="co">#&gt; [1,] 197005323       Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-110" data-line-number="110"><span class="co">#&gt; [2,]       Inf 294282876 291730500 236611435 191490147 227385872 331864344</span></a>
<a class="sourceLine" id="cb1-111" data-line-number="111"><span class="co">#&gt; [3,]       Inf       Inf 291636381 229477936 137459014  65199212  21733775</span></a>
<a class="sourceLine" id="cb1-112" data-line-number="112"><span class="co">#&gt; [4,]       Inf       Inf       Inf 229383816 137282211  64852959  21639656</span></a>
<a class="sourceLine" id="cb1-113" data-line-number="113"><span class="co">#&gt; [5,]       Inf       Inf       Inf       Inf 137188092  64758840  21480569</span></a>
<a class="sourceLine" id="cb1-114" data-line-number="114"><span class="co">#&gt;           [,8]        [,9]     [,10]</span></a>
<a class="sourceLine" id="cb1-115" data-line-number="115"><span class="co">#&gt; [1,]       Inf         Inf       Inf</span></a>
<a class="sourceLine" id="cb1-116" data-line-number="116"><span class="co">#&gt; [2,] 430019521 391678775.7 244781356</span></a>
<a class="sourceLine" id="cb1-117" data-line-number="117"><span class="co">#&gt; [3,]   6449890  21742914.5 105804433</span></a>
<a class="sourceLine" id="cb1-118" data-line-number="118"><span class="co">#&gt; [4,]   3646706   1134175.2   3862498</span></a>
<a class="sourceLine" id="cb1-119" data-line-number="119"><span class="co">#&gt; [5,]   3552587    440925.3   1045160</span></a>
<a class="sourceLine" id="cb1-120" data-line-number="120"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb1-121" data-line-number="121"><span class="co">#&gt; [1,] 372393353       Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-122" data-line-number="122"><span class="co">#&gt; [2,]       Inf 577239411 544573843 428902219 311790819 289822504 356410748</span></a>
<a class="sourceLine" id="cb1-123" data-line-number="123"><span class="co">#&gt; [3,]       Inf       Inf 544479724 421768720 257759686 127635844  46280179</span></a>
<a class="sourceLine" id="cb1-124" data-line-number="124"><span class="co">#&gt; [4,]       Inf       Inf       Inf 421674601 257582883 127289591  46186059</span></a>
<a class="sourceLine" id="cb1-125" data-line-number="125"><span class="co">#&gt; [5,]       Inf       Inf       Inf       Inf 257488764 127195472  46026972</span></a>
<a class="sourceLine" id="cb1-126" data-line-number="126"><span class="co">#&gt;           [,8]      [,9]     [,10]     [,11]</span></a>
<a class="sourceLine" id="cb1-127" data-line-number="127"><span class="co">#&gt; [1,]       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-128" data-line-number="128"><span class="co">#&gt; [2,] 435808921 392307481 244837631 197005323</span></a>
<a class="sourceLine" id="cb1-129" data-line-number="129"><span class="co">#&gt; [3,]  12239290  22371619 105860708 191490147</span></a>
<a class="sourceLine" id="cb1-130" data-line-number="130"><span class="co">#&gt; [4,]   9436107   1762880   3918773   6449890</span></a>
<a class="sourceLine" id="cb1-131" data-line-number="131"><span class="co">#&gt; [5,]   9341987   1069630   1101434   1134175</span></a>
<a class="sourceLine" id="cb1-132" data-line-number="132"><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb1-133" data-line-number="133"><span class="co">#&gt; [1,] 790227866       Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-134" data-line-number="134"><span class="co">#&gt; [2,]       Inf 900569372 826195050 638471938 440874878 355556661 381536894</span></a>
<a class="sourceLine" id="cb1-135" data-line-number="135"><span class="co">#&gt; [3,]       Inf       Inf 826100931 631338439 386843745 193370002  71406324</span></a>
<a class="sourceLine" id="cb1-136" data-line-number="136"><span class="co">#&gt; [4,]       Inf       Inf       Inf 631244320 386666942 193023749  71312205</span></a>
<a class="sourceLine" id="cb1-137" data-line-number="137"><span class="co">#&gt; [5,]       Inf       Inf       Inf       Inf 386572823 192929629  71153118</span></a>
<a class="sourceLine" id="cb1-138" data-line-number="138"><span class="co">#&gt;           [,8]      [,9]     [,10]     [,11]     [,12]</span></a>
<a class="sourceLine" id="cb1-139" data-line-number="139"><span class="co">#&gt; [1,]       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-140" data-line-number="140"><span class="co">#&gt; [2,] 441375516 392797147 244847819 197015173 372393353</span></a>
<a class="sourceLine" id="cb1-141" data-line-number="141"><span class="co">#&gt; [3,]  17805885  22861286 105870896 191499997 197005323</span></a>
<a class="sourceLine" id="cb1-142" data-line-number="142"><span class="co">#&gt; [4,]  15002702   2252546   3928961   6459739  12239290</span></a>
<a class="sourceLine" id="cb1-143" data-line-number="143"><span class="co">#&gt; [5,]  14908583   1559297   1111623   1144025   1762880</span></a>
<a class="sourceLine" id="cb1-144" data-line-number="144"><span class="co">#&gt;      [,1]       [,2]      [,3]      [,4]      [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb1-145" data-line-number="145"><span class="co">#&gt; [1,]    0        Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-146" data-line-number="146"><span class="co">#&gt; [2,]  Inf 1050478970 866032049 511769682 247411261 245398925 419493658</span></a>
<a class="sourceLine" id="cb1-147" data-line-number="147"><span class="co">#&gt; [3,]  Inf        Inf 865937930 504636183 193380128  83212266 109363089</span></a>
<a class="sourceLine" id="cb1-148" data-line-number="148"><span class="co">#&gt; [4,]  Inf        Inf       Inf 504542064 193203325  82866013 109268970</span></a>
<a class="sourceLine" id="cb1-149" data-line-number="149"><span class="co">#&gt; [5,]  Inf        Inf       Inf       Inf 193109206  82771893 109109883</span></a>
<a class="sourceLine" id="cb1-150" data-line-number="150"><span class="co">#&gt;           [,8]      [,9]     [,10]     [,11]     [,12]     [,13]</span></a>
<a class="sourceLine" id="cb1-151" data-line-number="151"><span class="co">#&gt; [1,]       Inf       Inf       Inf       Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb1-152" data-line-number="152"><span class="co">#&gt; [2,] 590258388 537181322 314503729 215989651 373458779 790227866</span></a>
<a class="sourceLine" id="cb1-153" data-line-number="153"><span class="co">#&gt; [3,] 166688756 167245461 175526806 210474475 198070750 197015173</span></a>
<a class="sourceLine" id="cb1-154" data-line-number="154"><span class="co">#&gt; [4,] 163885573 146636722  73584871  25434217  13304716  17805885</span></a>
<a class="sourceLine" id="cb1-155" data-line-number="155"><span class="co">#&gt; [5,] 163791454 145943472  70767533  20118503   2828306   2252546</span></a>
<a class="sourceLine" id="cb1-156" data-line-number="156"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></a>
<a class="sourceLine" id="cb1-157" data-line-number="157"><span class="co">#&gt;  [1,]    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb1-158" data-line-number="158"><span class="co">#&gt;  [2,]    0    1    0    0    0</span></a>
<a class="sourceLine" id="cb1-159" data-line-number="159"><span class="co">#&gt;  [3,]    0    2    2    0    0</span></a>
<a class="sourceLine" id="cb1-160" data-line-number="160"><span class="co">#&gt;  [4,]    0    2    3    3    0</span></a>
<a class="sourceLine" id="cb1-161" data-line-number="161"><span class="co">#&gt;  [5,]    0    2    3    3    4</span></a>
<a class="sourceLine" id="cb1-162" data-line-number="162"><span class="co">#&gt;  [6,]    0    2    2    5    5</span></a>
<a class="sourceLine" id="cb1-163" data-line-number="163"><span class="co">#&gt;  [7,]    0    2    6    6    6</span></a>
<a class="sourceLine" id="cb1-164" data-line-number="164"><span class="co">#&gt;  [8,]    0    1    6    7    7</span></a>
<a class="sourceLine" id="cb1-165" data-line-number="165"><span class="co">#&gt;  [9,]    0    3    7    8    8</span></a>
<a class="sourceLine" id="cb1-166" data-line-number="166"><span class="co">#&gt; [10,]    0    4    7    8    8</span></a>
<a class="sourceLine" id="cb1-167" data-line-number="167"><span class="co">#&gt; [11,]    0   10    7    8    8</span></a>
<a class="sourceLine" id="cb1-168" data-line-number="168"><span class="co">#&gt; [12,]    0   10    7    8    9</span></a>
<a class="sourceLine" id="cb1-169" data-line-number="169"><span class="co">#&gt; [13,]    0   10    5   11   12</span></a>
<a class="sourceLine" id="cb1-170" data-line-number="170"><span class="co">#&gt;               [,1]         [,2]        [,3]        [,4]       [,5]</span></a>
<a class="sourceLine" id="cb1-171" data-line-number="171"><span class="co">#&gt;  [1,]         0.00          Inf         Inf         Inf        Inf</span></a>
<a class="sourceLine" id="cb1-172" data-line-number="172"><span class="co">#&gt;  [2,]     94119.21         0.00         Inf         Inf        Inf</span></a>
<a class="sourceLine" id="cb1-173" data-line-number="173"><span class="co">#&gt;  [3,]   7227618.08     94119.21        0.00         Inf        Inf</span></a>
<a class="sourceLine" id="cb1-174" data-line-number="174"><span class="co">#&gt;  [4,]  54302054.87    270921.86    94119.21        0.00        Inf</span></a>
<a class="sourceLine" id="cb1-175" data-line-number="175"><span class="co">#&gt;  [5,] 162631616.49    444956.87    98703.72     4584.51       0.00</span></a>
<a class="sourceLine" id="cb1-176" data-line-number="176"><span class="co">#&gt;  [6,] 310482479.10    351909.84   257790.63    98703.72    4584.51</span></a>
<a class="sourceLine" id="cb1-177" data-line-number="177"><span class="co">#&gt;  [7,] 426724724.48   3155093.06   351909.84   257790.63   98703.72</span></a>
<a class="sourceLine" id="cb1-178" data-line-number="178"><span class="co">#&gt;  [8,] 391589760.30  21653899.02  1045159.73   351909.84  257790.63</span></a>
<a class="sourceLine" id="cb1-179" data-line-number="179"><span class="co">#&gt;  [9,] 244781356.33 105804433.15  3862497.98  1045159.73  351909.84</span></a>
<a class="sourceLine" id="cb1-180" data-line-number="180"><span class="co">#&gt; [10,] 197005323.27 191490147.02  6449889.52  1134175.16  440925.28</span></a>
<a class="sourceLine" id="cb1-181" data-line-number="181"><span class="co">#&gt; [11,] 372393352.54 197005323.27 12239289.74  1762880.09 1069630.21</span></a>
<a class="sourceLine" id="cb1-182" data-line-number="182"><span class="co">#&gt; [12,] 790227865.58 197015172.78 17805885.06  2252546.49 1111622.65</span></a>
<a class="sourceLine" id="cb1-183" data-line-number="183"><span class="co">#&gt; [13,]         0.00 215989650.90 83212265.80 13304716.11 2252546.49</span></a>
<a class="sourceLine" id="cb1-184" data-line-number="184"> <span class="kw">print</span>(a) <span class="co">#indices of months to select for follow-up experiments</span></a>
<a class="sourceLine" id="cb1-185" data-line-number="185"><span class="co">#&gt; [1]  2  6  8 12</span></a>
<a class="sourceLine" id="cb1-186" data-line-number="186"> <span class="kw">print</span>(<span class="kw">rownames</span>(CanadianWeather<span class="op">$</span>monthlyTemp)[a]) <span class="co">#month names selected</span></a>
<a class="sourceLine" id="cb1-187" data-line-number="187"><span class="co">#&gt; [1] &quot;Feb&quot; &quot;Jun&quot; &quot;Aug&quot; &quot;Dec&quot;</span></a></code></pre></div>
</div>
<div id="demo-of-f2" class="section level2">
<h2>Demo of F2</h2>
<p>In this example, we consider Canadian cities to be different experimental conditions, and we consider Resolute, Canada to be the control condition. We want to find a set of points that will enable us to estimate the profile of the difference in temperature between Resolute and other cities in Canada. In this case, we sample only 3 example curves from the distribution of curves when estimating the integral– this should be much higher (100 curves is usually suitable), but we make it 3 here to speed up loading the vignette.</p>
<p>Note that the tables that are printed as the evaluation are the optimisation tables that are used as part of the NITPicker algorithm’s dynamic programming algorithm.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(fda)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(NITPicker)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">mat=CanadianWeather<span class="op">$</span>monthlyTemp <span class="co">#load data - a matrix with 12 rows, representing months (time); and 35 columns, representing cities (experiments)</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"> y=CanadianWeather<span class="op">$</span>monthlyTemp[,<span class="st">&quot;Resolute&quot;</span>]</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">a=<span class="kw">findPathF2</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>), y, mat, <span class="dv">4</span>, <span class="dt">numPerts=</span><span class="dv">500</span>) <span class="co">#find a set of points that help predict the shape of the curve</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; lambda =   0.0 </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; Initializing...</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; Computing Karcher mean of 35 functions in SRSF space...</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; updating step: r=1</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; updating step: r=2</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; updating step: r=3</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; updating step: r=4</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co">#&gt; updating step: r=5</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co">#&gt; updating step: r=6</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co">#&gt; updating step: r=7</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="co">#&gt; updating step: r=8</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; updating step: r=9</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; updating step: r=10</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt; updating step: r=11</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt; updating step: r=12</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt; updating step: r=13</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt; updating step: r=14</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt; updating step: r=15</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt; updating step: r=16</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt; updating step: r=17</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt; updating step: r=18</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt; [1] 12  1</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt; [1,]    0</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt; [2,]  Inf</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt; [3,]  Inf</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt; [4,]  Inf</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt; [5,]  Inf</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"><span class="co">#&gt;          [,1] [,2]</span></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co">#&gt; [1,] 166747.5  Inf</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co">#&gt; [2,]      Inf    0</span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co">#&gt; [3,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co">#&gt; [4,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co">#&gt; [5,]      Inf  Inf</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt;         [,1]     [,2]     [,3]</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co">#&gt; [1,] 3896413      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43"><span class="co">#&gt; [2,]     Inf 21803.31 166747.5</span></a>
<a class="sourceLine" id="cb2-44" data-line-number="44"><span class="co">#&gt; [3,]     Inf      Inf      0.0</span></a>
<a class="sourceLine" id="cb2-45" data-line-number="45"><span class="co">#&gt; [4,]     Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-46" data-line-number="46"><span class="co">#&gt; [5,]     Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-47" data-line-number="47"><span class="co">#&gt;         [,1]    [,2]     [,3]       [,4]</span></a>
<a class="sourceLine" id="cb2-48" data-line-number="48"><span class="co">#&gt; [1,] 3221102     Inf      Inf        Inf</span></a>
<a class="sourceLine" id="cb2-49" data-line-number="49"><span class="co">#&gt; [2,]     Inf 1192634 797388.2 3896413.20</span></a>
<a class="sourceLine" id="cb2-50" data-line-number="50"><span class="co">#&gt; [3,]     Inf     Inf 630640.7   21803.31</span></a>
<a class="sourceLine" id="cb2-51" data-line-number="51"><span class="co">#&gt; [4,]     Inf     Inf      Inf       0.00</span></a>
<a class="sourceLine" id="cb2-52" data-line-number="52"><span class="co">#&gt; [5,]     Inf     Inf      Inf        Inf</span></a>
<a class="sourceLine" id="cb2-53" data-line-number="53"><span class="co">#&gt;          [,1]     [,2]    [,3]    [,4]       [,5]</span></a>
<a class="sourceLine" id="cb2-54" data-line-number="54"><span class="co">#&gt; [1,] 16516905      Inf     Inf     Inf        Inf</span></a>
<a class="sourceLine" id="cb2-55" data-line-number="55"><span class="co">#&gt; [2,]      Inf 17625001 9072491 5088276 3221102.24</span></a>
<a class="sourceLine" id="cb2-56" data-line-number="56"><span class="co">#&gt; [3,]      Inf      Inf 8905744 1213666  797388.18</span></a>
<a class="sourceLine" id="cb2-57" data-line-number="57"><span class="co">#&gt; [4,]      Inf      Inf     Inf 1191863   21803.31</span></a>
<a class="sourceLine" id="cb2-58" data-line-number="58"><span class="co">#&gt; [5,]      Inf      Inf     Inf     Inf       0.00</span></a>
<a class="sourceLine" id="cb2-59" data-line-number="59"><span class="co">#&gt;          [,1]     [,2]     [,3]    [,4]       [,5]        [,6]</span></a>
<a class="sourceLine" id="cb2-60" data-line-number="60"><span class="co">#&gt; [1,] 74589747      Inf      Inf     Inf        Inf         Inf</span></a>
<a class="sourceLine" id="cb2-61" data-line-number="61"><span class="co">#&gt; [2,]      Inf 40631572 19465838 6350294 3245040.22 16516904.61</span></a>
<a class="sourceLine" id="cb2-62" data-line-number="62"><span class="co">#&gt; [3,]      Inf      Inf 19299090 2475684  821326.16  3221102.24</span></a>
<a class="sourceLine" id="cb2-63" data-line-number="63"><span class="co">#&gt; [4,]      Inf      Inf      Inf 2453881   45741.29   797388.18</span></a>
<a class="sourceLine" id="cb2-64" data-line-number="64"><span class="co">#&gt; [5,]      Inf      Inf      Inf     Inf   23937.97    21803.31</span></a>
<a class="sourceLine" id="cb2-65" data-line-number="65"><span class="co">#&gt;           [,1]     [,2]     [,3]    [,4]    [,5]     [,6]        [,7]</span></a>
<a class="sourceLine" id="cb2-66" data-line-number="66"><span class="co">#&gt; [1,] 105552558      Inf      Inf     Inf     Inf      Inf         Inf</span></a>
<a class="sourceLine" id="cb2-67" data-line-number="67"><span class="co">#&gt; [2,]       Inf 44530574 18845609 5633819 4981716 16970796 74589746.59</span></a>
<a class="sourceLine" id="cb2-68" data-line-number="68"><span class="co">#&gt; [3,]       Inf      Inf 18678862 1759209 2558002  3674994  3245040.22</span></a>
<a class="sourceLine" id="cb2-69" data-line-number="69"><span class="co">#&gt; [4,]       Inf      Inf      Inf 1737406 1782418  1251280   821326.16</span></a>
<a class="sourceLine" id="cb2-70" data-line-number="70"><span class="co">#&gt; [5,]       Inf      Inf      Inf     Inf 1760614   475695    45741.29</span></a>
<a class="sourceLine" id="cb2-71" data-line-number="71"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]       [,7]</span></a>
<a class="sourceLine" id="cb2-72" data-line-number="72"><span class="co">#&gt; [1,] 79345757      Inf      Inf      Inf      Inf      Inf        Inf</span></a>
<a class="sourceLine" id="cb2-73" data-line-number="73"><span class="co">#&gt; [2,]      Inf 35136073 15167245 11610343 14990762 20650357 74964333.5</span></a>
<a class="sourceLine" id="cb2-74" data-line-number="74"><span class="co">#&gt; [3,]      Inf      Inf 15000498  7735733 12567048  7354555  3619627.1</span></a>
<a class="sourceLine" id="cb2-75" data-line-number="75"><span class="co">#&gt; [4,]      Inf      Inf      Inf  7713929 11791463  4930841  1195913.1</span></a>
<a class="sourceLine" id="cb2-76" data-line-number="76"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf 11769659  4155256   420328.2</span></a>
<a class="sourceLine" id="cb2-77" data-line-number="77"><span class="co">#&gt;             [,8]</span></a>
<a class="sourceLine" id="cb2-78" data-line-number="78"><span class="co">#&gt; [1,]         Inf</span></a>
<a class="sourceLine" id="cb2-79" data-line-number="79"><span class="co">#&gt; [2,] 105552557.9</span></a>
<a class="sourceLine" id="cb2-80" data-line-number="80"><span class="co">#&gt; [3,]   4981716.4</span></a>
<a class="sourceLine" id="cb2-81" data-line-number="81"><span class="co">#&gt; [4,]   1759209.2</span></a>
<a class="sourceLine" id="cb2-82" data-line-number="82"><span class="co">#&gt; [5,]    821326.2</span></a>
<a class="sourceLine" id="cb2-83" data-line-number="83"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]</span></a>
<a class="sourceLine" id="cb2-84" data-line-number="84"><span class="co">#&gt; [1,] 54139862      Inf      Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-85" data-line-number="85"><span class="co">#&gt; [2,]      Inf 32412714 19716015 26930568 32096174 27180841 75873330</span></a>
<a class="sourceLine" id="cb2-86" data-line-number="86"><span class="co">#&gt; [3,]      Inf      Inf 19549268 23055958 29672460 13885038  4528624</span></a>
<a class="sourceLine" id="cb2-87" data-line-number="87"><span class="co">#&gt; [4,]      Inf      Inf      Inf 23034155 28896875 11461324  2104910</span></a>
<a class="sourceLine" id="cb2-88" data-line-number="88"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf 28875071 10685739  1329325</span></a>
<a class="sourceLine" id="cb2-89" data-line-number="89"><span class="co">#&gt;             [,8]     [,9]</span></a>
<a class="sourceLine" id="cb2-90" data-line-number="90"><span class="co">#&gt; [1,]         Inf      Inf</span></a>
<a class="sourceLine" id="cb2-91" data-line-number="91"><span class="co">#&gt; [2,] 105560987.1 79345757</span></a>
<a class="sourceLine" id="cb2-92" data-line-number="92"><span class="co">#&gt; [3,]   4990145.7 11610343</span></a>
<a class="sourceLine" id="cb2-93" data-line-number="93"><span class="co">#&gt; [4,]   1767638.5  3619627</span></a>
<a class="sourceLine" id="cb2-94" data-line-number="94"><span class="co">#&gt; [5,]    829755.4  1195913</span></a>
<a class="sourceLine" id="cb2-95" data-line-number="95"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]</span></a>
<a class="sourceLine" id="cb2-96" data-line-number="96"><span class="co">#&gt; [1,] 42095449      Inf      Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-97" data-line-number="97"><span class="co">#&gt; [2,]      Inf 43458597 41901618 63156561 66617657 42422099 79581544</span></a>
<a class="sourceLine" id="cb2-98" data-line-number="98"><span class="co">#&gt; [3,]      Inf      Inf 41734871 59281952 64193943 29126297  8236838</span></a>
<a class="sourceLine" id="cb2-99" data-line-number="99"><span class="co">#&gt; [4,]      Inf      Inf      Inf 59260148 63418359 26702583  5813124</span></a>
<a class="sourceLine" id="cb2-100" data-line-number="100"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf 63396555 25926998  5037539</span></a>
<a class="sourceLine" id="cb2-101" data-line-number="101"><span class="co">#&gt;           [,8]     [,9]    [,10]</span></a>
<a class="sourceLine" id="cb2-102" data-line-number="102"><span class="co">#&gt; [1,]       Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-103" data-line-number="103"><span class="co">#&gt; [2,] 106115193 79487773 54139862</span></a>
<a class="sourceLine" id="cb2-104" data-line-number="104"><span class="co">#&gt; [3,]   5544352 11752358 19716015</span></a>
<a class="sourceLine" id="cb2-105" data-line-number="105"><span class="co">#&gt; [4,]   2321844  3761642  4528624</span></a>
<a class="sourceLine" id="cb2-106" data-line-number="106"><span class="co">#&gt; [5,]   1383961  1337928  1767638</span></a>
<a class="sourceLine" id="cb2-107" data-line-number="107"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]</span></a>
<a class="sourceLine" id="cb2-108" data-line-number="108"><span class="co">#&gt; [1,] 56439254      Inf      Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-109" data-line-number="109"><span class="co">#&gt; [2,]      Inf 53563786 57971766 87985589 89138500 50322728 80349975</span></a>
<a class="sourceLine" id="cb2-110" data-line-number="110"><span class="co">#&gt; [3,]      Inf      Inf 57805018 84110979 86714786 37026925  9005268</span></a>
<a class="sourceLine" id="cb2-111" data-line-number="111"><span class="co">#&gt; [4,]      Inf      Inf      Inf 84089176 85939201 34603211  6581554</span></a>
<a class="sourceLine" id="cb2-112" data-line-number="112"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf 85917398 33827626  5805970</span></a>
<a class="sourceLine" id="cb2-113" data-line-number="113"><span class="co">#&gt;           [,8]     [,9]    [,10]    [,11]</span></a>
<a class="sourceLine" id="cb2-114" data-line-number="114"><span class="co">#&gt; [1,]       Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-115" data-line-number="115"><span class="co">#&gt; [2,] 105923550 79444393 54292435 42095449</span></a>
<a class="sourceLine" id="cb2-116" data-line-number="116"><span class="co">#&gt; [3,]   5352708 11708978 19868588 41901618</span></a>
<a class="sourceLine" id="cb2-117" data-line-number="117"><span class="co">#&gt; [4,]   2130201  3718263  4681197  5544352</span></a>
<a class="sourceLine" id="cb2-118" data-line-number="118"><span class="co">#&gt; [5,]   1192318  1294549  1920212  2321844</span></a>
<a class="sourceLine" id="cb2-119" data-line-number="119"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]</span></a>
<a class="sourceLine" id="cb2-120" data-line-number="120"><span class="co">#&gt; [1,] 41358411      Inf      Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-121" data-line-number="121"><span class="co">#&gt; [2,]      Inf 40943793 41199224 69947404 73657089 40562669 79723102</span></a>
<a class="sourceLine" id="cb2-122" data-line-number="122"><span class="co">#&gt; [3,]      Inf      Inf 41032477 66072795 71233375 27266866  8378395</span></a>
<a class="sourceLine" id="cb2-123" data-line-number="123"><span class="co">#&gt; [4,]      Inf      Inf      Inf 66050991 70457791 24843152  5954681</span></a>
<a class="sourceLine" id="cb2-124" data-line-number="124"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf 70435987 24067568  5179096</span></a>
<a class="sourceLine" id="cb2-125" data-line-number="125"><span class="co">#&gt;           [,8]     [,9]    [,10]    [,11]    [,12]</span></a>
<a class="sourceLine" id="cb2-126" data-line-number="126"><span class="co">#&gt; [1,]       Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-127" data-line-number="127"><span class="co">#&gt; [2,] 111019466 84557237 58233886 42874727 56439254</span></a>
<a class="sourceLine" id="cb2-128" data-line-number="128"><span class="co">#&gt; [3,]  10448625 16821823 23810039 42680897 42095449</span></a>
<a class="sourceLine" id="cb2-129" data-line-number="129"><span class="co">#&gt; [4,]   7226117  8831107  8622648  6323630  5352708</span></a>
<a class="sourceLine" id="cb2-130" data-line-number="130"><span class="co">#&gt; [5,]   6288234  6407393  5861663  3101123  2130201</span></a>
<a class="sourceLine" id="cb2-131" data-line-number="131"><span class="co">#&gt;      [,1]     [,2]     [,3]      [,4]      [,5]     [,6]     [,7]</span></a>
<a class="sourceLine" id="cb2-132" data-line-number="132"><span class="co">#&gt; [1,]    0      Inf      Inf       Inf       Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-133" data-line-number="133"><span class="co">#&gt; [2,]  Inf 41324407 62190171 146071608 135335338 41725175 93547814</span></a>
<a class="sourceLine" id="cb2-134" data-line-number="134"><span class="co">#&gt; [3,]  Inf      Inf 62023424 142196998 132911624 28429373 22203107</span></a>
<a class="sourceLine" id="cb2-135" data-line-number="135"><span class="co">#&gt; [4,]  Inf      Inf      Inf 142175194 132136039 26005659 19779393</span></a>
<a class="sourceLine" id="cb2-136" data-line-number="136"><span class="co">#&gt; [5,]  Inf      Inf      Inf       Inf 132114236 25230074 19003808</span></a>
<a class="sourceLine" id="cb2-137" data-line-number="137"><span class="co">#&gt;           [,8]     [,9]    [,10]    [,11]    [,12]    [,13]</span></a>
<a class="sourceLine" id="cb2-138" data-line-number="138"><span class="co">#&gt; [1,]       Inf      Inf      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb2-139" data-line-number="139"><span class="co">#&gt; [2,] 137789880 99656274 63743239 42561751 56577039 41358411</span></a>
<a class="sourceLine" id="cb2-140" data-line-number="140"><span class="co">#&gt; [3,]  37219038 31920859 29319392 42367920 42233234 40562669</span></a>
<a class="sourceLine" id="cb2-141" data-line-number="141"><span class="co">#&gt; [4,]  33996531 23930144 14132000  6010654  5490494  8378395</span></a>
<a class="sourceLine" id="cb2-142" data-line-number="142"><span class="co">#&gt; [5,]  33058648 21506430 11371015  2788147  2267986  5352708</span></a>
<a class="sourceLine" id="cb2-143" data-line-number="143"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></a>
<a class="sourceLine" id="cb2-144" data-line-number="144"><span class="co">#&gt;  [1,]    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb2-145" data-line-number="145"><span class="co">#&gt;  [2,]    0    1    0    0    0</span></a>
<a class="sourceLine" id="cb2-146" data-line-number="146"><span class="co">#&gt;  [3,]    0    1    2    0    0</span></a>
<a class="sourceLine" id="cb2-147" data-line-number="147"><span class="co">#&gt;  [4,]    0    2    3    3    0</span></a>
<a class="sourceLine" id="cb2-148" data-line-number="148"><span class="co">#&gt;  [5,]    0    4    4    4    4</span></a>
<a class="sourceLine" id="cb2-149" data-line-number="149"><span class="co">#&gt;  [6,]    0    4    4    4    5</span></a>
<a class="sourceLine" id="cb2-150" data-line-number="150"><span class="co">#&gt;  [7,]    0    4    3    6    6</span></a>
<a class="sourceLine" id="cb2-151" data-line-number="151"><span class="co">#&gt;  [8,]    0    3    6    6    6</span></a>
<a class="sourceLine" id="cb2-152" data-line-number="152"><span class="co">#&gt;  [9,]    0    2    6    7    7</span></a>
<a class="sourceLine" id="cb2-153" data-line-number="153"><span class="co">#&gt; [10,]    0    2    7    7    8</span></a>
<a class="sourceLine" id="cb2-154" data-line-number="154"><span class="co">#&gt; [11,]    0   10    7    7    7</span></a>
<a class="sourceLine" id="cb2-155" data-line-number="155"><span class="co">#&gt; [12,]    0    5    6   11   11</span></a>
<a class="sourceLine" id="cb2-156" data-line-number="156"><span class="co">#&gt; [13,]    0    1    6   11   11</span></a>
<a class="sourceLine" id="cb2-157" data-line-number="157"><span class="co">#&gt;              [,1]        [,2]        [,3]       [,4]       [,5]</span></a>
<a class="sourceLine" id="cb2-158" data-line-number="158"><span class="co">#&gt;  [1,]         0.0         Inf         Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb2-159" data-line-number="159"><span class="co">#&gt;  [2,]    166747.5        0.00         Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb2-160" data-line-number="160"><span class="co">#&gt;  [3,]   3896413.2    21803.31        0.00        Inf        Inf</span></a>
<a class="sourceLine" id="cb2-161" data-line-number="161"><span class="co">#&gt;  [4,]   3221102.2   797388.18    21803.31       0.00        Inf</span></a>
<a class="sourceLine" id="cb2-162" data-line-number="162"><span class="co">#&gt;  [5,]  16516904.6  3221102.24   797388.18   21803.31       0.00</span></a>
<a class="sourceLine" id="cb2-163" data-line-number="163"><span class="co">#&gt;  [6,]  74589746.6  3245040.22   821326.16   45741.29   21803.31</span></a>
<a class="sourceLine" id="cb2-164" data-line-number="164"><span class="co">#&gt;  [7,] 105552557.9  4981716.43  1759209.21  821326.16   45741.29</span></a>
<a class="sourceLine" id="cb2-165" data-line-number="165"><span class="co">#&gt;  [8,]  79345757.5 11610342.60  3619627.14 1195913.09  420328.22</span></a>
<a class="sourceLine" id="cb2-166" data-line-number="166"><span class="co">#&gt;  [9,]  54139861.9 19716015.11  4528623.74 1767638.46  829755.42</span></a>
<a class="sourceLine" id="cb2-167" data-line-number="167"><span class="co">#&gt; [10,]  42095448.9 41901618.24  5544351.58 2321844.35 1337928.32</span></a>
<a class="sourceLine" id="cb2-168" data-line-number="168"><span class="co">#&gt; [11,]  56439254.0 42095448.88  5352708.12 2130200.89 1192317.84</span></a>
<a class="sourceLine" id="cb2-169" data-line-number="169"><span class="co">#&gt; [12,]  41358411.3 40562668.84  8378395.29 5352708.12 2130200.89</span></a>
<a class="sourceLine" id="cb2-170" data-line-number="170"><span class="co">#&gt; [13,]         0.0 41324407.30 22203107.16 5490493.53 2267986.31</span></a>
<a class="sourceLine" id="cb2-171" data-line-number="171"><span class="kw">print</span>(a) <span class="co">#indices of months to select for follow-up experiments</span></a>
<a class="sourceLine" id="cb2-172" data-line-number="172"><span class="co">#&gt; [1]  1  3  7 11</span></a>
<a class="sourceLine" id="cb2-173" data-line-number="173"><span class="kw">print</span>(<span class="kw">rownames</span>(CanadianWeather<span class="op">$</span>monthlyTemp)[a])</a>
<a class="sourceLine" id="cb2-174" data-line-number="174"><span class="co">#&gt; [1] &quot;Jan&quot; &quot;Mar&quot; &quot;Jul&quot; &quot;Nov&quot;</span></a></code></pre></div>
</div>
<div id="demo-of-f3" class="section level2">
<h2>Demo of F3</h2>
<p>In this example, we try to identify points that can predict the shape of the curve of the difference between the temperatures of Canadian cities that are along the Atlantic with those that are Continental– however, we don’t care too much about sampling time points where there is lots of noise, so we normalise this by the variance at each point.</p>
<p>In this case, we sample only 3 example curves from the distribution of curves when estimating the integral– this should be much higher (100 curves is usually suitable), but we make it 3 here to speed up loading the vignette.</p>
<p>Note that the tables that are printed as the evaluation are the optimisation tables that are used as part of the NITPicker algorithm’s dynamic programming algorithm.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(fda)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">library</span>(NITPicker)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#Set up data:</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">atlanticCities=<span class="kw">which</span>(CanadianWeather<span class="op">$</span>region[<span class="kw">as.character</span>(<span class="kw">colnames</span>(CanadianWeather<span class="op">$</span>monthlyTemp))]<span class="op">==</span><span class="st">&quot;Atlantic&quot;</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"> matAtlantic=CanadianWeather<span class="op">$</span>monthlyTemp[, <span class="kw">names</span>(atlanticCities)]</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"> </a>
<a class="sourceLine" id="cb3-7" data-line-number="7"> continentalCities=<span class="kw">which</span>(CanadianWeather<span class="op">$</span>region[<span class="kw">as.character</span>(<span class="kw">colnames</span>(CanadianWeather<span class="op">$</span>monthlyTemp))]<span class="op">==</span><span class="st">&quot;Continental&quot;</span>)</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"> matContinental=CanadianWeather<span class="op">$</span>monthlyTemp[, <span class="kw">names</span>(continentalCities)]</a>
<a class="sourceLine" id="cb3-9" data-line-number="9"> </a>
<a class="sourceLine" id="cb3-10" data-line-number="10"> <span class="co">#find a set of points that helps capture the difference between Atlantic and Continental cities, normalised by the variance</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"> a=<span class="kw">findPathF3</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">12</span>),  matAtlantic,  matContinental, <span class="dv">4</span>, <span class="dt">numPerts=</span><span class="dv">500</span>) <span class="co">#find a set of points that help predict the shape of the curve</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; lambda =   0.0 </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt; Initializing...</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt; Computing Karcher mean of 15 functions in SRSF space...</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt; updating step: r=1</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt; updating step: r=2</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt; updating step: r=3</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt; updating step: r=4</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt; updating step: r=5</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt; updating step: r=6</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt; updating step: r=7</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt; updating step: r=8</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt; updating step: r=9</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt; updating step: r=10</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt; updating step: r=11</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; lambda =   0.0 </span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; Initializing...</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; Computing Karcher mean of 12 functions in SRSF space...</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; updating step: r=1</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"><span class="co">#&gt; updating step: r=2</span></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co">#&gt; updating step: r=3</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">#&gt; updating step: r=4</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">#&gt; updating step: r=5</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">#&gt; updating step: r=6</span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; [1] 12  1</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">#&gt;      [,1]</span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; [1,]    0</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">#&gt; [2,]  Inf</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">#&gt; [3,]  Inf</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">#&gt; [4,]  Inf</span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; [5,]  Inf</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">#&gt;         [,1] [,2]</span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">#&gt; [1,] 1805.35  Inf</span></a>
<a class="sourceLine" id="cb3-46" data-line-number="46"><span class="co">#&gt; [2,]     Inf    0</span></a>
<a class="sourceLine" id="cb3-47" data-line-number="47"><span class="co">#&gt; [3,]     Inf  Inf</span></a>
<a class="sourceLine" id="cb3-48" data-line-number="48"><span class="co">#&gt; [4,]     Inf  Inf</span></a>
<a class="sourceLine" id="cb3-49" data-line-number="49"><span class="co">#&gt; [5,]     Inf  Inf</span></a>
<a class="sourceLine" id="cb3-50" data-line-number="50"><span class="co">#&gt;          [,1]     [,2]    [,3]</span></a>
<a class="sourceLine" id="cb3-51" data-line-number="51"><span class="co">#&gt; [1,] 6055.183      Inf     Inf</span></a>
<a class="sourceLine" id="cb3-52" data-line-number="52"><span class="co">#&gt; [2,]      Inf 1692.906 1805.35</span></a>
<a class="sourceLine" id="cb3-53" data-line-number="53"><span class="co">#&gt; [3,]      Inf      Inf    0.00</span></a>
<a class="sourceLine" id="cb3-54" data-line-number="54"><span class="co">#&gt; [4,]      Inf      Inf     Inf</span></a>
<a class="sourceLine" id="cb3-55" data-line-number="55"><span class="co">#&gt; [5,]      Inf      Inf     Inf</span></a>
<a class="sourceLine" id="cb3-56" data-line-number="56"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]</span></a>
<a class="sourceLine" id="cb3-57" data-line-number="57"><span class="co">#&gt; [1,] 93997.03      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb3-58" data-line-number="58"><span class="co">#&gt; [2,]      Inf 1922.912 4722.562 6055.183</span></a>
<a class="sourceLine" id="cb3-59" data-line-number="59"><span class="co">#&gt; [3,]      Inf      Inf 2917.212 1692.906</span></a>
<a class="sourceLine" id="cb3-60" data-line-number="60"><span class="co">#&gt; [4,]      Inf      Inf      Inf    0.000</span></a>
<a class="sourceLine" id="cb3-61" data-line-number="61"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb3-62" data-line-number="62"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]</span></a>
<a class="sourceLine" id="cb3-63" data-line-number="63"><span class="co">#&gt; [1,] 209946.7      Inf      Inf      Inf       Inf</span></a>
<a class="sourceLine" id="cb3-64" data-line-number="64"><span class="co">#&gt; [2,]      Inf 1310.847 4181.313 7135.119 93997.028</span></a>
<a class="sourceLine" id="cb3-65" data-line-number="65"><span class="co">#&gt; [3,]      Inf      Inf 2375.963 2772.841  1922.912</span></a>
<a class="sourceLine" id="cb3-66" data-line-number="66"><span class="co">#&gt; [4,]      Inf      Inf      Inf 1079.936  1692.906</span></a>
<a class="sourceLine" id="cb3-67" data-line-number="67"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf     0.000</span></a>
<a class="sourceLine" id="cb3-68" data-line-number="68"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]       [,6]</span></a>
<a class="sourceLine" id="cb3-69" data-line-number="69"><span class="co">#&gt; [1,] 181418.1      Inf      Inf      Inf       Inf        Inf</span></a>
<a class="sourceLine" id="cb3-70" data-line-number="70"><span class="co">#&gt; [2,]      Inf 21761.75 13726.70 22545.43 96325.788 209946.719</span></a>
<a class="sourceLine" id="cb3-71" data-line-number="71"><span class="co">#&gt; [3,]      Inf      Inf 11921.35 18183.15  4251.671   1310.847</span></a>
<a class="sourceLine" id="cb3-72" data-line-number="72"><span class="co">#&gt; [4,]      Inf      Inf      Inf 16490.25  4021.665   1922.912</span></a>
<a class="sourceLine" id="cb3-73" data-line-number="73"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf  2328.759   1079.936</span></a>
<a class="sourceLine" id="cb3-74" data-line-number="74"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]       [,6]       [,7]</span></a>
<a class="sourceLine" id="cb3-75" data-line-number="75"><span class="co">#&gt; [1,] 104971.1      Inf      Inf      Inf       Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb3-76" data-line-number="76"><span class="co">#&gt; [2,]      Inf 110548.1 65873.06 69141.66 107619.40 210587.939 181418.116</span></a>
<a class="sourceLine" id="cb3-77" data-line-number="77"><span class="co">#&gt; [3,]      Inf      Inf 64067.71 64779.38  15545.28   1952.067  13726.695</span></a>
<a class="sourceLine" id="cb3-78" data-line-number="78"><span class="co">#&gt; [4,]      Inf      Inf      Inf 63086.48  15315.27   2564.131   1310.847</span></a>
<a class="sourceLine" id="cb3-79" data-line-number="79"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf  13622.37   1721.155   1922.912</span></a>
<a class="sourceLine" id="cb3-80" data-line-number="80"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]       [,6]       [,7]</span></a>
<a class="sourceLine" id="cb3-81" data-line-number="81"><span class="co">#&gt; [1,] 121147.4      Inf      Inf      Inf       Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb3-82" data-line-number="82"><span class="co">#&gt; [2,]      Inf 278635.5 168293.1 149018.4 130623.23 213341.357 181546.937</span></a>
<a class="sourceLine" id="cb3-83" data-line-number="83"><span class="co">#&gt; [3,]      Inf      Inf 166487.7 144656.1  38549.11   4705.484  13855.517</span></a>
<a class="sourceLine" id="cb3-84" data-line-number="84"><span class="co">#&gt; [4,]      Inf      Inf      Inf 142963.2  38319.11   5317.549   1439.669</span></a>
<a class="sourceLine" id="cb3-85" data-line-number="85"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf  36626.20   4474.573   2051.733</span></a>
<a class="sourceLine" id="cb3-86" data-line-number="86"><span class="co">#&gt;            [,8]</span></a>
<a class="sourceLine" id="cb3-87" data-line-number="87"><span class="co">#&gt; [1,]        Inf</span></a>
<a class="sourceLine" id="cb3-88" data-line-number="88"><span class="co">#&gt; [2,] 104971.142</span></a>
<a class="sourceLine" id="cb3-89" data-line-number="89"><span class="co">#&gt; [3,]  65873.063</span></a>
<a class="sourceLine" id="cb3-90" data-line-number="90"><span class="co">#&gt; [4,]   1952.067</span></a>
<a class="sourceLine" id="cb3-91" data-line-number="91"><span class="co">#&gt; [5,]   1310.847</span></a>
<a class="sourceLine" id="cb3-92" data-line-number="92"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]      [,6]       [,7]</span></a>
<a class="sourceLine" id="cb3-93" data-line-number="93"><span class="co">#&gt; [1,] 480461.1      Inf      Inf      Inf       Inf       Inf        Inf</span></a>
<a class="sourceLine" id="cb3-94" data-line-number="94"><span class="co">#&gt; [2,]      Inf 616890.4 386154.4 312250.4 191397.61 228356.32 185097.684</span></a>
<a class="sourceLine" id="cb3-95" data-line-number="95"><span class="co">#&gt; [3,]      Inf      Inf 384349.1 307888.1  99323.50  19720.45  17406.264</span></a>
<a class="sourceLine" id="cb3-96" data-line-number="96"><span class="co">#&gt; [4,]      Inf      Inf      Inf 306195.2  99093.49  20332.51   4990.416</span></a>
<a class="sourceLine" id="cb3-97" data-line-number="97"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf  97400.58  19489.54   5602.480</span></a>
<a class="sourceLine" id="cb3-98" data-line-number="98"><span class="co">#&gt;            [,8]       [,9]</span></a>
<a class="sourceLine" id="cb3-99" data-line-number="99"><span class="co">#&gt; [1,]        Inf        Inf</span></a>
<a class="sourceLine" id="cb3-100" data-line-number="100"><span class="co">#&gt; [2,] 105689.731 121147.444</span></a>
<a class="sourceLine" id="cb3-101" data-line-number="101"><span class="co">#&gt; [3,]  66591.653 104971.142</span></a>
<a class="sourceLine" id="cb3-102" data-line-number="102"><span class="co">#&gt; [4,]   2670.656   4705.484</span></a>
<a class="sourceLine" id="cb3-103" data-line-number="103"><span class="co">#&gt; [5,]   2029.437   1439.669</span></a>
<a class="sourceLine" id="cb3-104" data-line-number="104"><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]      [,5]      [,6]       [,7]</span></a>
<a class="sourceLine" id="cb3-105" data-line-number="105"><span class="co">#&gt; [1,] 578579.8      Inf      Inf      Inf       Inf       Inf        Inf</span></a>
<a class="sourceLine" id="cb3-106" data-line-number="106"><span class="co">#&gt; [2,]      Inf 691096.5 411397.5 321843.8 177374.00 219736.63 184888.254</span></a>
<a class="sourceLine" id="cb3-107" data-line-number="107"><span class="co">#&gt; [3,]      Inf      Inf 409592.2 317481.5  85299.88  11100.75  17196.833</span></a>
<a class="sourceLine" id="cb3-108" data-line-number="108"><span class="co">#&gt; [4,]      Inf      Inf      Inf 315788.6  85069.88  11712.82   4780.985</span></a>
<a class="sourceLine" id="cb3-109" data-line-number="109"><span class="co">#&gt; [5,]      Inf      Inf      Inf      Inf  83376.97  10869.84   5393.050</span></a>
<a class="sourceLine" id="cb3-110" data-line-number="110"><span class="co">#&gt;            [,8]       [,9]      [,10]</span></a>
<a class="sourceLine" id="cb3-111" data-line-number="111"><span class="co">#&gt; [1,]        Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb3-112" data-line-number="112"><span class="co">#&gt; [2,] 109045.224 124786.484 480461.076</span></a>
<a class="sourceLine" id="cb3-113" data-line-number="113"><span class="co">#&gt; [3,]  69947.146 108610.182 105689.731</span></a>
<a class="sourceLine" id="cb3-114" data-line-number="114"><span class="co">#&gt; [4,]   6026.149   8344.524  17406.264</span></a>
<a class="sourceLine" id="cb3-115" data-line-number="115"><span class="co">#&gt; [5,]   5384.930   5078.709   2670.656</span></a>
<a class="sourceLine" id="cb3-116" data-line-number="116"><span class="co">#&gt;         [,1]    [,2]     [,3]     [,4]     [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb3-117" data-line-number="117"><span class="co">#&gt; [1,] 2042185     Inf      Inf      Inf      Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb3-118" data-line-number="118"><span class="co">#&gt; [2,]     Inf 1326369 833448.1 632931.4 309871.6 260889.56 197031.08</span></a>
<a class="sourceLine" id="cb3-119" data-line-number="119"><span class="co">#&gt; [3,]     Inf     Inf 831642.7 628569.1 217797.5  52253.69  29339.66</span></a>
<a class="sourceLine" id="cb3-120" data-line-number="120"><span class="co">#&gt; [4,]     Inf     Inf      Inf 626876.2 217567.5  52865.75  16923.81</span></a>
<a class="sourceLine" id="cb3-121" data-line-number="121"><span class="co">#&gt; [5,]     Inf     Inf      Inf      Inf 215874.6  52022.78  17535.88</span></a>
<a class="sourceLine" id="cb3-122" data-line-number="122"><span class="co">#&gt;            [,8]       [,9]     [,10]      [,11]</span></a>
<a class="sourceLine" id="cb3-123" data-line-number="123"><span class="co">#&gt; [1,]        Inf        Inf       Inf        Inf</span></a>
<a class="sourceLine" id="cb3-124" data-line-number="124"><span class="co">#&gt; [2,] 112806.301 126913.321 488376.51 578579.778</span></a>
<a class="sourceLine" id="cb3-125" data-line-number="125"><span class="co">#&gt; [3,]  73708.223 110737.018 113605.17 109045.224</span></a>
<a class="sourceLine" id="cb3-126" data-line-number="126"><span class="co">#&gt; [4,]   9787.226  10471.361  25321.70  11100.755</span></a>
<a class="sourceLine" id="cb3-127" data-line-number="127"><span class="co">#&gt; [5,]   9146.007   7205.545  10586.09   4780.985</span></a>
<a class="sourceLine" id="cb3-128" data-line-number="128"><span class="co">#&gt;         [,1]    [,2]     [,3]     [,4]     [,5]      [,6]      [,7]</span></a>
<a class="sourceLine" id="cb3-129" data-line-number="129"><span class="co">#&gt; [1,] 1331458     Inf      Inf      Inf      Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb3-130" data-line-number="130"><span class="co">#&gt; [2,]     Inf 1019380 587255.2 436436.1 207423.4 241625.43 215532.80</span></a>
<a class="sourceLine" id="cb3-131" data-line-number="131"><span class="co">#&gt; [3,]     Inf     Inf 585449.9 432073.8 115349.3  32989.56  47841.38</span></a>
<a class="sourceLine" id="cb3-132" data-line-number="132"><span class="co">#&gt; [4,]     Inf     Inf      Inf 430380.9 115119.3  33601.62  35425.54</span></a>
<a class="sourceLine" id="cb3-133" data-line-number="133"><span class="co">#&gt; [5,]     Inf     Inf      Inf      Inf 113426.4  32758.64  36037.60</span></a>
<a class="sourceLine" id="cb3-134" data-line-number="134"><span class="co">#&gt;           [,8]      [,9]     [,10]     [,11]       [,12]</span></a>
<a class="sourceLine" id="cb3-135" data-line-number="135"><span class="co">#&gt; [1,]       Inf       Inf       Inf       Inf         Inf</span></a>
<a class="sourceLine" id="cb3-136" data-line-number="136"><span class="co">#&gt; [2,] 141092.70 152294.15 495792.96 598250.69 2042184.691</span></a>
<a class="sourceLine" id="cb3-137" data-line-number="137"><span class="co">#&gt; [3,] 101994.63 136117.85 121021.62 128716.14  112806.301</span></a>
<a class="sourceLine" id="cb3-138" data-line-number="138"><span class="co">#&gt; [4,]  38073.63  35852.19  32738.15  30771.67   29339.659</span></a>
<a class="sourceLine" id="cb3-139" data-line-number="139"><span class="co">#&gt; [5,]  37432.41  32586.38  18002.54  24451.90    9787.226</span></a>
<a class="sourceLine" id="cb3-140" data-line-number="140"><span class="co">#&gt;      [,1]     [,2]     [,3]     [,4]     [,5]      [,6]     [,7]     [,8]</span></a>
<a class="sourceLine" id="cb3-141" data-line-number="141"><span class="co">#&gt; [1,]    0      Inf      Inf      Inf      Inf       Inf      Inf      Inf</span></a>
<a class="sourceLine" id="cb3-142" data-line-number="142"><span class="co">#&gt; [2,]  Inf 839090.2 412346.1 369184.8 611792.2 1021578.5 922147.8 599818.4</span></a>
<a class="sourceLine" id="cb3-143" data-line-number="143"><span class="co">#&gt; [3,]  Inf      Inf 410540.8 364822.5 519718.1  812942.6 754456.4 560720.3</span></a>
<a class="sourceLine" id="cb3-144" data-line-number="144"><span class="co">#&gt; [4,]  Inf      Inf      Inf 363129.6 519488.1  813554.7 742040.6 496799.3</span></a>
<a class="sourceLine" id="cb3-145" data-line-number="145"><span class="co">#&gt; [5,]  Inf      Inf      Inf      Inf 517795.2  812711.7 742652.6 496158.1</span></a>
<a class="sourceLine" id="cb3-146" data-line-number="146"><span class="co">#&gt;          [,9]     [,10]     [,11]      [,12]      [,13]</span></a>
<a class="sourceLine" id="cb3-147" data-line-number="147"><span class="co">#&gt; [1,]      Inf       Inf       Inf        Inf        Inf</span></a>
<a class="sourceLine" id="cb3-148" data-line-number="148"><span class="co">#&gt; [2,] 382343.3 543884.77 626678.77 2042983.32 1331458.35</span></a>
<a class="sourceLine" id="cb3-149" data-line-number="149"><span class="co">#&gt; [3,] 366167.0 169113.42 157144.22  113604.93  141092.70</span></a>
<a class="sourceLine" id="cb3-150" data-line-number="150"><span class="co">#&gt; [4,] 265901.4  80829.96  59199.75   30138.29   32989.56</span></a>
<a class="sourceLine" id="cb3-151" data-line-number="151"><span class="co">#&gt; [5,] 262635.6  66094.35  52879.98   10585.86   29339.66</span></a>
<a class="sourceLine" id="cb3-152" data-line-number="152"><span class="co">#&gt;       [,1] [,2] [,3] [,4] [,5]</span></a>
<a class="sourceLine" id="cb3-153" data-line-number="153"><span class="co">#&gt;  [1,]    0    0    0    0    0</span></a>
<a class="sourceLine" id="cb3-154" data-line-number="154"><span class="co">#&gt;  [2,]    0    1    0    0    0</span></a>
<a class="sourceLine" id="cb3-155" data-line-number="155"><span class="co">#&gt;  [3,]    0    1    2    0    0</span></a>
<a class="sourceLine" id="cb3-156" data-line-number="156"><span class="co">#&gt;  [4,]    0    1    3    3    0</span></a>
<a class="sourceLine" id="cb3-157" data-line-number="157"><span class="co">#&gt;  [5,]    0    1    4    3    4</span></a>
<a class="sourceLine" id="cb3-158" data-line-number="158"><span class="co">#&gt;  [6,]    0    2    5    5    5</span></a>
<a class="sourceLine" id="cb3-159" data-line-number="159"><span class="co">#&gt;  [7,]    0    2    5    6    5</span></a>
<a class="sourceLine" id="cb3-160" data-line-number="160"><span class="co">#&gt;  [8,]    0    7    5    6    7</span></a>
<a class="sourceLine" id="cb3-161" data-line-number="161"><span class="co">#&gt;  [9,]    0    7    6    7    8</span></a>
<a class="sourceLine" id="cb3-162" data-line-number="162"><span class="co">#&gt; [10,]    0    7    5    6    9</span></a>
<a class="sourceLine" id="cb3-163" data-line-number="163"><span class="co">#&gt; [11,]    0    7    6    7   10</span></a>
<a class="sourceLine" id="cb3-164" data-line-number="164"><span class="co">#&gt; [12,]    0    7    5   11   11</span></a>
<a class="sourceLine" id="cb3-165" data-line-number="165"><span class="co">#&gt; [13,]    0    3   11   11   11</span></a>
<a class="sourceLine" id="cb3-166" data-line-number="166"><span class="co">#&gt;              [,1]       [,2]       [,3]      [,4]      [,5]</span></a>
<a class="sourceLine" id="cb3-167" data-line-number="167"><span class="co">#&gt;  [1,]       0.000        Inf        Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb3-168" data-line-number="168"><span class="co">#&gt;  [2,]    1805.350      0.000        Inf       Inf       Inf</span></a>
<a class="sourceLine" id="cb3-169" data-line-number="169"><span class="co">#&gt;  [3,]    6055.183   1692.906      0.000       Inf       Inf</span></a>
<a class="sourceLine" id="cb3-170" data-line-number="170"><span class="co">#&gt;  [4,]   93997.028   1922.912   1692.906     0.000       Inf</span></a>
<a class="sourceLine" id="cb3-171" data-line-number="171"><span class="co">#&gt;  [5,]  209946.719   1310.847   1922.912  1079.936     0.000</span></a>
<a class="sourceLine" id="cb3-172" data-line-number="172"><span class="co">#&gt;  [6,]  181418.116  13726.695   1310.847  1922.912  1079.936</span></a>
<a class="sourceLine" id="cb3-173" data-line-number="173"><span class="co">#&gt;  [7,]  104971.142  65873.063   1952.067  1310.847  1721.155</span></a>
<a class="sourceLine" id="cb3-174" data-line-number="174"><span class="co">#&gt;  [8,]  121147.444 104971.142   4705.484  1439.669  1310.847</span></a>
<a class="sourceLine" id="cb3-175" data-line-number="175"><span class="co">#&gt;  [9,]  480461.076 105689.731  17406.264  2670.656  1439.669</span></a>
<a class="sourceLine" id="cb3-176" data-line-number="176"><span class="co">#&gt; [10,]  578579.778 109045.224  11100.755  4780.985  2670.656</span></a>
<a class="sourceLine" id="cb3-177" data-line-number="177"><span class="co">#&gt; [11,] 2042184.691 112806.301  29339.659  9787.226  4780.985</span></a>
<a class="sourceLine" id="cb3-178" data-line-number="178"><span class="co">#&gt; [12,] 1331458.352 141092.705  32989.556 29339.659  9787.226</span></a>
<a class="sourceLine" id="cb3-179" data-line-number="179"><span class="co">#&gt; [13,]       0.000 369184.768 113604.931 30138.289 10585.856</span></a>
<a class="sourceLine" id="cb3-180" data-line-number="180"> <span class="kw">print</span>(a) <span class="co">#indices of months to select for follow-up experiments</span></a>
<a class="sourceLine" id="cb3-181" data-line-number="181"><span class="co">#&gt; [1]  1  5  7 11</span></a>
<a class="sourceLine" id="cb3-182" data-line-number="182"> <span class="kw">print</span>(<span class="kw">rownames</span>(CanadianWeather<span class="op">$</span>monthlyTemp)[a]) <span class="co">#month names selected</span></a>
<a class="sourceLine" id="cb3-183" data-line-number="183"><span class="co">#&gt; [1] &quot;Jan&quot; &quot;May&quot; &quot;Jul&quot; &quot;Nov&quot;</span></a></code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
